
%%
import codegen.kinematics.p_com_RightStance
import codegen.kinematics.J_com_RightStance

p_com_RightStance(q0)
p_com_RightStance(qf)
codegen.kinematics.J_com_RightStance(qf)

import codegen.Xiaobin_outputs.Dya_RightStanceActual_new

codegen.Xiaobin_outputs.Dya_RightStanceActual_new(q0)


codegen.Xiaobin_outputs.yaRightStance_new(q0)


%%
% note:
% bounds in quadprog: replace 1e+20 with inf
% need Hessian positive definite
import codegen.constraints.J_achilles_constraint
import codegen.constraints.J_left_fixed_constraint
import codegen.constraints.Jdot_achilles_constraint
import codegen.constraints.Jdot_left_fixed_constraint

import codegen.constraints.J_rightSole_constraint
import codegen.constraints.Jdot_rightSole_constraint
import codegen.dynamics.De_cassie_v4
import codegen.dynamics.Fvectot_cassie_v4

import codegen.outputs.Dya_RightStanceActual
import codegen.outputs.DLfya_RightStanceActual

q = [0                   
	0                   
	0                   
	0.00019543232732216 
	0.00097413659166418 
	1.0900131900995e-15 
	-0.0068450421094894 
	0.00030737355700694 
	0.61938959360123    
	-1.4768937826157    
	-0                  
	1.7038594000219     
	-0                  
	-1.7541842460632    
	0.0062695788219571  
	0.0015448236372322  
	0.61898279190063    
	-1.4778516292572    
	-0.032671991735697  
	1.7703795433044     
	-0.024107446811273  
	-1.7329775094986     ];
dq = [0.0001888647264047   
	-0.00045173291924082 
	-0.0021366542205215  
	0.0006977956312046   
	0.0015287919668481   
	-3.7817555676975e-05 
	-0.00021304188703652 
	9.3674927484244e-05  
	-0.0011908172164112  
	0.0043903086334467   
	-0                   
	-0.0043903247751081  
	-0                   
	0.0016515346942469   
	-0.00017643721366767 
	-9.0437919425312e-05 
	-0.0032153415959328  
	0.0085162408649921   
	-0.0082410285249352  
	0.0084643373265862   
	-0.0064688537446388  
	0.00091261637862772  ];

Jc = [J_achilles_constraint(q);
J_left_fixed_constraint(q)];
dJc = [Jdot_achilles_constraint(q,dq);
Jdot_left_fixed_constraint(q,dq)];

Js = J_rightSole_constraint(q);
dJs = Jdot_rightSole_constraint(q,dq);

Proj = eye(22) - pinv(Jc)*Jc;
D = De_cassie_v4(q);
Fvec = Fvectot_cassie_v4(q,dq);

Dc = D + Proj*D - (Proj*D)';
Hc = -Proj*Fvec + D*pinv(Jc)*dJc*dq;
%%
Fs = [4.681409320164e-310  
	4.6814080516042e-310 
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	75.799020826817      
	0                    
	48.697042558772      
	0                 ];
Be = [0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 0 
	1 0 0 0 0 0 0 0 0 0 
	0 1 0 0 0 0 0 0 0 0 
	0 0 1 0 0 0 0 0 0 0 
	0 0 0 1 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 1 0 0 0 0 0 
	0 0 0 0 0 1 0 0 0 0 
	0 0 0 0 0 0 1 0 0 0 
	0 0 0 0 0 0 0 1 0 0 
	0 0 0 0 0 0 0 0 1 0 
	0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 0 
	0 0 0 0 0 0 0 0 0 1 ];
cone = [	0  0  -1                0  0  
	1  0  -0.42426406871193 0  0  
	-1 0  -0.42426406871193 0  0  
	0  1  -0.42426406871193 0  0  
	0  -1 -0.42426406871193 0  0  
	0  0  -0.05238          0  1  
	0  0  -0.05238          0  -1 
	0  0  -0.0873           1  0  
	0  0  -0.0873           -1 0  ];
lb = [-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-inf 
	-112.5 
	-112.5 
	-195.2 
	-195.2 
	-45    
	-112.5 
	-112.5 
	-195.2 
	-195.2 
	0      
	-600   
	-600   
	0      
	-400   
	-400   
	0      ];
ub = [inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	inf 
	112.5 
	112.5 
	195.2 
	195.2 
	45    
	112.5 
	112.5 
	195.2 
	195.2 
	0     
	600   
	600   
	1200  
	400   
	400   
	10000 ];

ya = [0.00019543232732216 
	0.00097413659166418 
	0.0015448236372322  
	0.7731279283918     
	0.77345296033773    
	-0.023434613158286  
	-0.0068450421094894 
	0.00030737355700694 
	0.036213024991064      ];
dya = [0.0006977956312046   
	0.0015287919668481   
	-9.0437919425312e-05 
	0.0028906543805669   
	0.0014893847560622   
	-0.00089414461311995 
	-0.00021304188703652 
	9.3674927484244e-05  
	0.0010687405651836   ];
yd = [0.025096339638916    
	-7.626366607966e-06  
	0.0015448236372322   
	0.73650525325119     
	0.74323217399783     
	-0.023434613158286   
	-0.0068450421094894  
	0.00030737355700694  
	-2.0019950211251e-05  ];
dyd = [-0.19734024599028   
	0.002998385625497   
	9.5571645942981e-05 
	0.42384400527042    
	-0.039542633734828  
	-0.0060997162030403 
	-0.0007214238285087 
	-0.001240954385139  
	0.0030124450352481  ];
d2yd = [0.15737204032508   
	-0.12868518028212  
	-0.28799366330818  
	26.103806566857    
	-33.820280443558   
	-25.089700607128   
	-6.4530833672305   
	-0.060729267279948 
	-0.19366852384137  ];
y = ya-yd;
dy = dya-dyd;





Aconstr = zeros(36,38);
G = zeros(38,38);
g = zeros(38,1);
lbA = zeros(36,1);
ubA = zeros(36,1);


Aconstr(1:22,1:22) = Dc;
Aconstr(1:22,23:32) = -Proj*Be;
Aconstr(1:22,33:37) = -Proj*Js';
lbA(1:22) = -Hc + Proj*Fs;
ubA(1:22) = lbA(1:22);

Aconstr(23:23+8,33:37) = cone;
lbA(23:23+8) = -inf;

Aconstr(32:36,1:22) = Js;
lbA(32:36) = dJs*dq;
ubA(32:36) = lbA(32:36);

import codegen.outputs.Dya_RightStanceActual
import codegen.outputs.DLfya_RightStanceActual
Jy = Dya_RightStanceActual(q); Jy = Jy(:,1:22);
dJy = DLfya_RightStanceActual(q,dq); dJy = dJy(:,1:22);
G(1:22,1:22) = Jy'*Jy * 1.4^2;
G = G + eye(38)*.001;

Kp = [3000, 2500, 2500, 6000, 6500, 3600, 2000, 2500, 4500];
Kd = [35, 300, 200, 25, 60, 60, 20, 200, 16];
by = d2yd - dJy*dq - diag(Kp)*y - diag(Kd)*dy;
g(1:22) = -1.4^2*Jy'*by;
x0 = [-8.9049273657585     
	2.4375206332323      
	-20.048905074713     
	28.654766696667      
	-15.893118188066     
	-12.833936983355     
	-26.564973869377     
	-0.69191662238029    
	344.20904357419      
	-651.33226005987     
	-2.2651300072851e-12 
	651.33465478645      
	-8.5322732086151e-13 
	163.1571593306       
	-31.896513413578     
	12.645615361116      
	448.60420289082      
	-538.99746508466     
	39.078880314568      
	-34.753302990759     
	575.66356889516      
	70.099618365921      
	6.52444268655        
	-1.8460061235768     
	-10.941301904251     
	-166.67776409881     
	2.8221442984358      
	-69.896748767912     
	-14.442079223277     
	77.496283165066      
	13.380812968316      
	0                    
	-4.8585437366875     
	82.322839047963      
	194.03679245781      
	2.8666244819415      
	10.16364718894       
	0               ];

x = quadprog(G,g,[Aconstr;-Aconstr],[ubA;-lbA],[],[],lb,ub,x0)

x2 = quadprog(G,g,[Aconstr;-Aconstr],[ubA;-lbA],[],[],[],[],x0)

%%
Aconstr_cpp = [34.676752            0                    0                    1.5847220862985e-06  -4.1620378921564     -0.0021001082152282  8.5238123077915e-07  -0.19121457802313    1.4272760571552      1.3370688281528      1.2497697158235      0.63427776550156     -0.018341129922007   0.0036815029656747   8.4408320844393e-07  0.1912646247518      1.4055818860874      1.203854374522       1.1162626462995      0.51721833866334     0.33614031746717    0.0035702661215641   0  0  0  0                    0  0  0  0  0                    0  -1                   0                    0                    0                    0                    0 
	0                    34.676752            0                    4.1620454733087      -1.5847220862972e-06 -0.63322620661531    2.2386571587065      -0.026539476604505   0.0002579770429107   -0.0037435707069163  -0.0051442143579773  -0.00015316387554875 0.0013593285645504   1.4644263208934e-05  2.2168635921843      -0.038044606335449   0.0024122537303703   0.005789633860047    0.0057834557942023   0.0011337812201873   0.0008230211594953  -8.0795286408906e-06 0  0  0  0                    0  0  0  0  0                    0  0                    -1                   0                    0                    0                    0 
	0                    0                    34.676752            0.0020998669504055   0.63322500402567     -1.3456414434096e-18 0.17609168528673     0.0001816658290867   -0.026483582200124   -0.60700824760207    -0.8077012761191     -0.050892955047991   -0.008871902640438   0.0019738373125498   -0.17756599127992    -0.0002385267873775  -0.038326412214057   -0.64873021604124    -0.67692810875502    -0.075258041783963   -0.18062469730918   0.0021686047518418   0  0  0  0                    0  0  0  0  0                    0  0                    0                    -1                   0                    0                    0 
	1.5847220862985e-06  4.1620454733087      0.0020998669504055   2.567895051107       -0.0017951317184669  -0.44595792433149    1.0015286756725      -0.1112936889205     -0.00099868916721278 -0.077390762696017   -0.1030273794616     -0.0062506202269562  -0.00050443562829231 0.00025902400997754  0.9723640696993      -0.11464296253101    0.004088544532286    0.084448247294999    0.08796981938731     0.010129358366716    0.023174922804314   -0.00027772457682685 0  0  0  0                    0  0  0  0  0                    0  0                    -0.89397142370858    0.12466077566619     0.0014251775169945   0.017562498842903    0 
	-4.1620378921564     -1.5847220862972e-06 0.63322500402567     -0.0017951317184669  2.3229756315553      0.0022828401112005   0.0055142804995952   0.011701582099309    -0.8718157151677     -1.0687274689501     -1.1115438599801     -0.51346226614588    0.0038703443178956   -0.0036822963502438  -0.0057441149598917  -0.012009877271538   -0.85097854395003    -0.97778290810589    -0.97319076775905    -0.43256068086734    -0.29018995524495   -0.0035072224901806  0  0  0  0                    0  0  0  0  0                    0  0.89394704389114     2.2052877188615e-06  -0.011284149971515   -0.99999896533713    -0.00017040262264364 0 
	-0.0021001082152282  -0.63322620661531    -1.3456414434096e-18 -0.44595792433149    0.0022828401112005   1.0445207422467      -0.22189948893736    0.1736731767965      -0.18024962242019    -0.16464103215291    -0.1526660700309     -0.078072798490697   0.0016358391393474   -0.00045580166508705 -0.22419097669613    0.18022238114637     0.1779679516476      0.14859352985291     0.13714589801631     0.063780739060102    0.041742391986122   0.00044416076907124  0  0  0  0                    0  0  0  0  0                    0  -0.12483542496952    0.010413294479507    0.00012364189058814  0.00019682035222615  -0.99998240305365    0 
	8.5238123077915e-07  2.2386571587065      0.17609168528673     1.0015286756725      0.0055142804995952   -0.22189948893736    1.0158812512256      -0.11131821385585    0.0025766014883995   0.004555512514482    0.0060125080888568   0.00061994226888026  0.00069327359277035  -7.4445532980517e-06 0                    0                    0                    -1.170932652991e-19  4.3519783120416e-20  3.2199410778997e-20  2.928015151893e-20  0                    -1 0  0  0                    0  0  0  0  0                    0  0                    0                    0                    0                    0                    0 
	-0.19121457802313    -0.026539476604505   0.0001816658290867   -0.1112936889205     0.011701582099309    0.1736731767965      -0.11131821385585    0.18476033305312     0.006486647701142    0.0085679414151814   0.0084631040846278   0.004049595063756    -0.00074412445438412 1.6051384127956e-05  0                    0                    0                    -2.9197890817354e-19 1.0851912556192e-19  8.0291114771357e-20  7.3011770999939e-20 0                    0  -1 0  0                    0  0  0  0  0                    0  0                    0                    0                    0                    0                    0 
	1.4272760571552      0.0002579770429107   -0.026483582200124   -0.00099868916721278 -0.8718157151677     -0.18024962242019    0.0025766014883995   0.006486647701142    0.83556846929089     0.91873191842573     0.95957176834848     0.45392325382966     -0.0026593840976344  0.0034478745997782   0                    0                    0                    -3.1688232779125e-17 1.1777492193886e-17  8.7139292042902e-18  7.9239079614856e-18 0                    0  0  -1 0                    0  0  0  0  0                    0  0                    0                    0                    0                    0                    0 
	0.35139307336018     -0.0017951965337832  -0.27805653039853    -0.035569928965146   -0.27763063673499    -0.043283814167576   0.0019677767482886   0.002259157425062    0.23240264337135     0.61734853627172     0.63028126181046     0.36094602467109     -0.0011127686275947  0.00036432981784618  -7.3373171105775e-20 -1.7070311431088e-19 1.6931371902789e-17  -1.2847824746792e-17 2.500754542924e-17   1.063865629684e-17   8.1191708566279e-18 5.8183761164192e-20  0  0  0  -0.4999981616746     0  0  0  0  -4.7331605628564e-17 0  -1.7876079194219e-17 -6.1349197863636e-20 5.233412315778e-18   1.6723935995717e-17  1.0818028692419e-19  0 
	0                    0                    0                    0                    0                    0                    0                    0                    0                    0.26344724846826     0.39364652136516     0.2634462798665      0.00050203344467629  0                    2.5789854197122e-21  6.0000247539058e-21  -5.9511890538395e-19 -2.4980670519588e-17 8.5733608189311e-18  6.6196650959563e-18  6.0741690687986e-18 -2.0450945413024e-21 0  0  0  -3.4281616018054e-18 0  0  0  0  1.6636533349726e-18  0  6.2832431675946e-19  2.1563561233202e-21  -1.8394862664824e-19 -5.8782776378818e-19 -3.8024168571857e-21 0 
	-0.35139436531218    0.0017952031341061   0.27805755271718     0.035570059743595    0.27763165748777     0.043283973307339    -0.0019677839831299  -0.0022591657312103  -0.23240349783628    -0.18289205357478    -0.10338908219876    0.073509803379902    0.0028384038809248   -0.00036433115736215 -7.3372901338742e-20 -1.7070248669629e-19 1.6931309652161e-17  1.2284776061412e-17  1.5666495421819e-17  3.7274304944695e-18  1.8345355265546e-18 5.8183547243213e-20  0  0  0  0.49999999999662     0  0  0  0  -4.7331431607098e-17 0  -1.7876013470239e-17 -6.1348972304473e-20 5.2333930743837e-18  1.6723874507757e-17  1.0817988918378e-19  0 
	-1.7347234759768e-18 0                    0                    -5.4210108624275e-20 6.505213034913e-19   0                    0                    0                    -2.168404344971e-19  0.00086281558102463  0.00050203344467629  0.00086281240875886  0.00185729584        -3.8341921187111e-21 1.728951720812e-21   4.0224163517518e-21  -3.9896769004073e-19 -5.4634100324811e-19 -2.7369577164093e-19 -1.7197978079174e-20 2.1002123874673e-20 -1.3710312975723e-21 0  0  0  -1.861459107196e-35  0  0  0  0  1.115313128314e-18   0  4.2122859648058e-19  1.4456210576459e-21  -1.2331915184692e-19 -3.9407970901054e-19 -2.549140106891e-21  0 
	0.0036815029656747   1.4644263208934e-05  0.0019738373125498   0.00025902400997754  -0.0036822963502438  -0.00045580166508705 -7.4445532980517e-06 1.6051384127956e-05  0.0034478745997782   0.0055369725165629   0.0054036629508999   0.0048082925233886   3.8341921187111e-21  0.0128154871764      0                    0                    0                    -2.4033367317926e-19 8.9324260507873e-20  6.6089220818609e-20  6.0097447515999e-20 0                    0  0  0  0                    -1 0  0  0  0                    0  0                    0                    0                    0                    0                    0 
	8.4408320844393e-07  2.2168635921843      -0.17756599127992    0.9723640696993      -0.0057441149598917  -0.22419097669613    0                    0                    0                    7.3373171105775e-20  -2.5789854197122e-21 7.3372901338742e-20  -1.728951720812e-21  0                    0.98651761355034     -0.11467516371088    -0.0010855313316437  -0.003130504774828   -0.0034156557143824  -3.0497332435947e-05 -0.0012094594738233 1.5037642663986e-05  0  0  0  0                    0  -1 0  0  0                    0  -9.9016252100098e-06 -0.89395560849521    -0.010339218998316   0.0014249864632314   0.018536626933767    0 
	0.1912646247518      -0.038044606335449   -0.0002385267873775  -0.11464296253101    -0.012009877271538   0.18022238114637     0                    0                    0                    1.7070311431088e-19  -6.0000247539058e-21 1.7070248669629e-19  -4.0224163517518e-21 0                    -0.11467516371088    0.19073464159329     -0.0063440915221001  -0.0077122293217977  -0.007372717120583   -0.0032993701450178  -0.0018323769697232 -1.5566408421098e-05 0  0  0  0                    0  0  -1 0  0                    0  0.0045593772076226   -0.038585874298921   -0.00025390316097586 0.0064663477454469   -0.9999616813089     0 
	1.4055818860874      0.0024122537303703   -0.038326412214057   0.004088544532286    -0.85097854395003    0.1779679516476      0                    0                    0                    -1.6931371902789e-17 5.9511890538395e-19  -1.6931309652161e-17 3.9896769004073e-19  0                    -0.0010855313316437  -0.0063440915221001  0.81609155877802     0.83770883633583     0.8396156036329      0.38235181045782     0.25110153451721    0.003292346922879    0  0  0  0                    0  0  0  -1 0                    0  -0.80404003075237    -0.00099266381564299 -0.03781767581219    0.99997908577817     0.0064684548210048   0 
	0.44088211402135     0.0024465761340662   -0.25956268563707    0.033826417687119    -0.33265706166615    0.054567556223513    1.170932652991e-19   2.9197890817354e-19  3.1688232779125e-17  1.2847824746792e-17  2.4980670519588e-17  -1.2284776061412e-17 5.4634100324811e-19  2.4033367317926e-19  -0.0012146140544054  -0.0028258067444551  0.28028067975752     0.60368040108088     0.58305656311206     0.3012130082494      0.24816369666018    0.00096316968427483  0  0  0  -4.7331605628564e-17 0  0  0  0  -0.78352390318729    0  -0.29591929447428    -0.0010155700895665  0.086633520882971    0.27684680107515     0.0017908084784601   0 
	0.089888142219263    0.0012862684215401   -0.153407593395      0.019871727295041    -0.10534700070725    0.010659173595682    -4.3519783120416e-20 -1.0851912556192e-19 -1.1777492193886e-17 -2.500754542924e-17  -8.5733608189311e-18 -1.5666495421819e-17 2.7369577164093e-19  -8.9324260507873e-20 -0.0008383387005825  -0.00079934635838072 0.089745552796473    0.28623357978909     0.38287628917844     0.22012665490555     0.20011911129386    9.4432819148804e-05  0  0  0  1.7591628403517e-17  0  0  0  0  0.29121051709739     0  -0.078743419439551   -0.00070673967819548 0.090553465871701    0.027198581793109    0.00017593647709864  0 
	-0.24217547951187    -0.0021935971162764  0.31208424065957     -0.040255048064674   0.20953943874893     -0.029804240130635   -3.2199410778997e-20 -8.0291114771357e-20 -8.7139292042902e-18 -1.063865629684e-17  -6.6196650959563e-18 -3.7274304944695e-18 1.7197978079174e-20  -6.6089220818609e-20 0.0018764076033129   0.0015641344544688   -0.17246193323528    -0.13469403902423    -0.070838498528852   0.073510994275583    0.0515271529549     0.00041015726536774  0  0  0  1.3015691453908e-17  0  0  0  0  0.21546079485824     0  0.066043122096634    0.0017482344318734   -0.25463301390656    0.2802383885659      0.0018127472677482   0 
	-0.35440542609693    -0.0022026907866378  0.17160040387287     -0.022641538392072   0.29369615750809     -0.04335799663304    -2.928015151893e-20  -7.3011770999939e-20 -7.9239079614856e-18 -8.1191708566279e-18 -6.0741690687986e-18 -1.8345355265546e-18 -2.1002123874673e-20 -6.0097447515999e-20 0.00052456186694428  0.0025901931376424   -0.25341174964247    -0.24806082820043    -0.19877134468534    -0.047842227095597   0.00185729584       -0.0016555978972209  0  0  0  1.1835664339008e-17  0  0  0  0  0.19592671316685     0  0.37136672674412     0.00024999498581866  0.049708502432828    -0.6544876492728     -0.0042336123329342  0 
	0.0035702661215641   -8.0795286408906e-06 0.0021686047518418   -0.00027772457682685 -0.0035072224901806  0.00044416076907124  0                    0                    0                    -5.8183761164192e-20 2.0450945413024e-21  -5.8183547243213e-20 1.3710312975723e-21  0                    1.5037642663986e-05  -1.5566408421098e-05 0.003292346922879    0.0046216536642157   0.0050159416013072   0.0040514824643166   0.0016555978972209  0.0128154871764      0  0  0  0                    0  0  0  0  0                    -1 -0.050945931447591   5.7061782875192e-05  -0.020946821068848   0.99997908577817     0.0064684548210048   0 
	0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                   0                    0  0  0  0                    0  0  0  0  0                    0  0                    0                    -1                   0                    0                    0 
	0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                   0                    0  0  0  0                    0  0  0  0  0                    0  1                    0                    -0.42426406871193    0                    0                    0 
	0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                   0                    0  0  0  0                    0  0  0  0  0                    0  -1                   0                    -0.42426406871193    0                    0                    0 
	0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                   0                    0  0  0  0                    0  0  0  0  0                    0  0                    1                    -0.42426406871193    0                    0                    0 
	0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                   0                    0  0  0  0                    0  0  0  0  0                    0  0                    -1                   -0.42426406871193    0                    0                    0 
	0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                   0                    0  0  0  0                    0  0  0  0  0                    0  0                    0                    -0.05238             0                    1                    0 
	0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                   0                    0  0  0  0                    0  0  0  0  0                    0  0                    0                    -0.05238             0                    -1                   0 
	0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                   0                    0  0  0  0                    0  0  0  0  0                    0  0                    0                    -0.0873              1                    0                    0 
	0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                    0                   0                    0  0  0  0                    0  0  0  0  0                    0  0                    0                    -0.0873              -1                   0                    0 
	1                    0                    0                    0                    -0.89394704389114    0.12483542496952     0                    0                    0                    0                    0                    0                    0                    0                    9.9016252100098e-06  -0.0045593772076226  0.80404003075237     0.70623608176818     0.63071458651477     0.34234922438268     0                   0.050945931447591    0  0  0  0                    0  0  0  0  0                    0  0                    0                    0                    0                    0                    0 
	0                    1                    0                    0.89397142370858     -2.2052877188615e-06 -0.010413294479507   0                    0                    0                    0                    0                    0                    0                    0                    0.89395560849521     0.038585874298921    0.00099266381564299  0.0012917853022755   0.0010783131503131   -0.0014733147055919  0                   -5.7061782875192e-05 0  0  0  0                    0  0  0  0  0                    0  0                    0                    0                    0                    0                    0 
	0                    0                    1                    -0.12466077566619    0.011284149971515    -0.00012364189058814 0                    0                    0                    0                    0                    0                    0                    0                    0.010339218998316    0.00025390316097586  0.03781767581219     -0.031711441034169   -0.016670540651223   0.30929750182796     0                   0.020946821068848    0  0  0  0                    0  0  0  0  0                    0  0                    0                    0                    0                    0                    0 
	0                    0                    0                    -0.0014251775169945  0.99999896533713     -0.00019682035222615 0                    0                    0                    0                    0                    0                    0                    0                    -0.0014249864632314  -0.0064663477454469  -0.99997908577817    -0.99997908577817    -0.99997908577817    -0.99997908577817    0                   -0.99997908577817    0  0  0  0                    0  0  0  0  0                    0  0                    0                    0                    0                    0                    0 
	0                    0                    0                    -0.017562498842903   0.00017040262264364  0.99998240305365     0                    0                    0                    0                    0                    0                    0                    0                    -0.018536626933767   0.9999616813089      -0.0064684548210048  -0.0064684548210048  -0.0064684548210048  -0.0064684548210048  0                   -0.0064684548210048  0  0  0  0                    0  0  0  0  0                    0  0                    0                    0                    0                    0                    0 ];

lbA_cpp = [1.9013066956384e-05  
	-1.4738448160842e-06 
	-340.06147574372     
	-0.020588934488022   
	-6.2098336759836     
	2.3902171423741e-06  
	-1.7268707041775     
	-0.0017812424733639  
	0.25971574956103     
	2.7268037826768      
	2.3640913498625e-10  
	-2.7268138078106     
	7.7430613200093e-13  
	-0.019356735273005   
	1.741328381583       
	0.0023387038026175   
	0.37586681523397     
	-29.069068823528     
	34.774586384746      
	-34.526747976066     
	18.400759068063      
	-0.021266694395026   
	-inf               
	-inf               
	-inf               
	-inf               
	-inf               
	-inf               
	-inf               
	-inf               
	-inf               
	-1.4762865566086e-07 
	2.864471504557e-06   
	-1.5361108912708e-05 
	-1.9541967310758e-07 
	4.6028541004383e-06  ];
ubA_cpp = [1.9013066956384e-05  
	-1.4738448160842e-06 
	-340.06147574372     
	-0.020588934488022   
	-6.2098336759836     
	2.3902171423741e-06  
	-1.7268707041775     
	-0.0017812424733639  
	0.25971574956103     
	2.7268037826768      
	2.3640913498625e-10  
	-2.7268138078106     
	7.7430613200093e-13  
	-0.019356735273005   
	1.741328381583       
	0.0023387038026175   
	0.37586681523397     
	-29.069068823528     
	34.774586384746      
	-34.526747976066     
	18.400759068063      
	-0.021266694395026   
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	0                    
	-1.4762865566086e-07 
	2.864471504557e-06   
	-1.5361108912708e-05 
	-1.9541967310758e-07 
	4.6028541004383e-06  ];
G_cpp = [0.0010000000011991 0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0.0010000000011991 0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0.0010000000011991 0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  1.9610000000012 0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               1.9610000000012 0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0.0010000000011991 0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  1.9610000000012 0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               1.9610000000012 0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               1.9610000000012      0.93080590160535     0                  0                  0                  -2.7467548532724e-16 0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0.93080590160535     0.66860981415327     0                  0                  0                  -2.0597260690451e-16 0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0.0010000000011991 0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0.0010000000011991 0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0.0010000000011991 0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               -2.7467548532724e-16 -2.0597260690451e-16 0                  0                  0                  1.9610000000012      0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0.0010000000011991 0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  1.9610000000012 0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0.0010000000011991 0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0.2268148696739     0                  0                  0                  1.1201154872332e-16 0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0.0010000000011991 0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0.0010000000011991 0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0.0010000000011991 0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  1.1201154872332e-16 0                  0                  0                  0.0010000000011991  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0.0010000000011991 0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0.0010000000011991 0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0.0010000000011991 0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0.0010000000011991 0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0.0010000000011991 0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0.0010000000011991 0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0.0010000000011991 0                  0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0.0010000000011991 0                  0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0.0010000000011991 0                  0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0.0010000000011991 0                  0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0.0010000000011991 0                  0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0.0010000000011991 0                  0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0.0010000000011991 0                  0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0.0010000000011991 0                  0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0.0010000000011991 0                  
	0                  0                  0                  0               0               0                  0               0               0                    0                    0                  0                  0                  0                    0                  0               0                  0                   0                  0                  0                  0                   0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0                  0.0010000000011991 ];
g_cpp = [0                   
	0                   
	0                   
	-133.14037453598    
	4.1987403776009     
	0                   
	12.648043399772     
	0.1190293638687     
	-49.175812358158    
	131.38422764332     
	0                   
	0                   
	0                   
	-319.8940921166     
	0                   
	0.56446758008404    
	0                   
	121.8183080962      
	0                   
	0                   
	0                   
	6.0425858458689e-14 
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   
	0                   ];
%%
max(max(abs(Aconstr-Aconstr_cpp)))
max(max(abs(ubA-ubA_cpp)))
max(max(abs(lbA-lbA_cpp)))
max(max(abs(G-G_cpp)))
max(max(abs(g-g_cpp)))
